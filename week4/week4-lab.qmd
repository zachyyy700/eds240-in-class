---
title: "Week 4 Lab"
author: "Zach Loo"
---

```{r}
library(tidyverse)
```


```{r}
#url <- "https://gml.noaa.gov/webdata/ccgg/trends/co2/co2_mm_mlo.csv"

mauna_loa_df <- read_csv(here::here("week4", "data", "co2_weekly_mlo.csv"), skip = 35, na = c(-999.99, "NA")) |> janitor::clean_names()
head(mauna_loa_df)
```

```{r}
mauna_loa_df |> 
    group_by(year) |> 
    summarise(avg_avg = mean(average, na.rm = TRUE)) |> 
    ggplot(aes(year, avg_avg)) +
    geom_line(linewidth = 10, linetype = 'dashed')
```

```{r}
mauna_loa_df |> 
    group_by(year) |> 
    summarise(avg_inc = mean(increase_since_1800, na.rm = TRUE)) |> 
    ggplot() +
    geom_col(aes(year, avg_inc), fill = "darkblue") +
    
    labs(x = "Year", y = "Average CO2 Increase (ppm) since 1800", title = "ğŸŒ‹Mauna LoağŸŒ‹", subtitle = "Big Island sux", caption = "Data retrieved from NOAA\n Global Monitoring Laboratory at Mauna Loa") +

    

    annotate(geom = "text", x = 2000, y = 102, label = "ğŸ„ğŸ½â€â™‚ï¸", size = 30) +
    annotate(geom = "text", x = 2010, y = 118, label = "ğŸ„ğŸ½â€â™‚ï¸", size = 20) +
    annotate(geom = "text", x = 2015, y = 128, label = "ğŸ„ğŸ½â€â™‚ï¸", size = 10) +

    annotate(geom = "text", x = 1975, y = 142, label = "ğŸŒ", size = 100) +

    theme_minimal() +

    scale_x_continuous(breaks = seq(1970, 2020, by = 5), expand = c(0,0)) +
    scale_y_continuous(breaks = seq(0, 150, by = 10), expand = c(0,0)) +

    theme(plot.title = element_text(hjust= 0.5), plot.subtitle = element_text(hjust= 0.5), panel.background = element_rect(fill = 'skyblue'), panel.grid = element_line(color = 'skyblue'), axis.text = element_text(size = 15), axis.ticks = element_line(color = 'black', linewidth = 1.2), axis.line = element_line(color = 'black'), axis.title = element_text(size = 20, family = ))
```